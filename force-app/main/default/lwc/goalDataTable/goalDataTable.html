<template>
	<lightning-card>
		<div class="tableFixHead">
			<table class="slds-table_cell-buffer slds-no-row-hover slds-table_bordered fixed_header">
				<thead>
					<tr class="slds-line-height_reset" style="color:lightcoral">
						<th class="slds-border_right tableheading" scope="col" style="width: 15%;">
							<div class="slds-truncate" title="Goal Name">Goal Name</div>
						</th>
						<th class="slds-border_right tableheading" scope="col" style="width: 15%;">
							<div class="slds-truncate" title="Resource Name">Resource Name</div>
						</th>
						<th class="slds-border_right tableheading" scope="col" style="width: 15%;">
							<div class="slds-truncate" title="Requested From">Requested From</div>
						</th>
						<th class="slds-border_right tableheading" scope="col" style="width: 5% !important;">
							<div class="slds-truncate" title="Start Date">Start Date</div>
						</th>
						<th class="slds-border_right tableheading" scope="col" style="width: 5% !important;">
							<div class="slds-truncate" title="End Date">End Date</div>
						</th>
						<th class="slds-border_right tableheading" scope="col" style="width: 15%;">
							<div class="slds-truncate"> </div>
						</th>
					</tr>
				</thead>

				<tbody>
					<template if:true={hasData}>
						<template for:each={data} for:item="goal">
							<tr key={goal.Id}>
								<td style="word-wrap:break-word; width: 15%;">
									<div class="slds-wrap">{goal.goalName}</div>
								</td>
								<td style="width: 15%;">
									<div class="slds-wrap">
										<div class="slds-wrap">
											<lightning-formatted-text value={goal.resourceName} ></lightning-formatted-text>
										</div>
									</div>
								</td>
								<td style="width: 15%;">
									<div class="slds-wrap">
										<div class="slds-wrap">
											<lightning-formatted-text value={goal.requestedByName} ></lightning-formatted-text>
										</div>
									</div>
								</td>
								<td style="width: 15%;">
									<div class="slds-wrap">
										<lightning-formatted-date-time value={goal.startDate}>
										</lightning-formatted-date-time>
									</div>
								</td>
								<td style="width: 15%;">
									<div class="slds-wrap">
										<lightning-formatted-date-time value={goal.endDate}>
										</lightning-formatted-date-time>
									</div>
								</td>
								<td class="slds-text-align_center slds-p-around_medium">

									<lightning-button-group>
										<lightning-button variant="brand-outline" label="Edit" data-id={goal.Id} onclick={editKRAModalPopUp} disabled={goal.hideEditBtn} ></lightning-button>
										<lightning-button variant="destructive-text" label="Reject" data-id={goal.Id} onclick={showModalPopUp} disabled={goal.hideRejectBtn}></lightning-button>
										<lightning-button variant="destructive-text" label="Accept" data-id={goal.Id} onclick={acceptRequestHandler} disabled={goal.hideAcceptBtn}></lightning-button>										
									</lightning-button-group>
									
									<template if:true={isShowPopUp}>
										<section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01"
											aria-modal="true" aria-describedby="modal-content-id-1"
											class="slds-modal slds-fade-in-open">
											<div class="slds-modal__container">
												<header class="slds-modal__header">
													<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={hideModalBox}>
                										<lightning-icon icon-name="utility:close"
                   														alternative-text="close"
                   														variant="inverse"
                   														size="small" ></lightning-icon>
                													<span class="slds-assistive-text">Close</span>
             										</button>
													<h2 id="modal-heading-01"
														class="slds-text-heading_medium slds-hyphenate">Rejection Reason</h2>
												</header>
												<div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
													<lightning-textarea variant="label-stacked" required label="Enter rejection reason" value={comment} onchange={handleCommentChange} field-level-help="Rejection reason for declining the KRA request"></lightning-textarea>
												</div>
												<footer class="slds-modal__footer">
													<button class="slds-button slds-button_neutral" onclick={handleRejectionSubmission}>Submit</button>
												</footer>
											</div>
										</section>
										<div class="slds-backdrop slds-backdrop_open"></div>
									</template>

									<template if:true={showKRAEditModal}>
										<lightning-card>
											<section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
												aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
												<div class="slds-modal__container">													
													<header class="slds-modal__header">
														<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={hideKRAEditModalBox}>
									                <lightning-icon icon-name="utility:close"
									                   alternative-text="close"
									                   variant="inverse"
									                   size="small" ></lightning-icon>
									                <span class="slds-assistive-text">Close</span>
									             </button>
														<h2 id="modal-heading-02" class="slds-text-heading_medium slds-hyphenate">Quarterly KRA Edit</h2>
													</header>																					
													<div class="slds-modal__content slds-p-around_medium" id="modal-content-id-2">														
														<c-quarterlykraedit mode={mode} receivedkraid={selectedKraQuaterly} onclose={hideKRAEditModalBox} tab="Pending Feedback Request"> </c-quarterlykraedit>
													</div>																					
													<footer class="slds-modal__footer">									
														<button class="slds-button slds-button_neutral" onclick={hideKRAEditModalBox}>Close</button>
													</footer>									
												</div>
											</section>
											<div class="slds-backdrop slds-backdrop_open"></div>
										</lightning-card>
									</template>
								</td>
							</tr>
						</template>
					</template>
				</tbody>
			</table>

			<template if:false={hasData}>
				<div class="slds-text-align_center slds-p-around_medium">
					<center>No KRA records found.</center>
				</div>
			</template>
		</div>
	</lightning-card>
</template>